# Story 5.1: Settings Screen

## Status

Approved

## Story

**As a** user,  
**I want** to access my settings,  
**so that** I can manage my account and preferences.

## Acceptance Criteria

1. Settings screen accessible from main navigation/menu
2. Shows account info: email, auth provider (Google/Apple/Guest)
3. Shows "Sign In" for guests, "Sign Out" for authenticated users
4. Links to: Manage car tags, Data retention, Privacy policy, Terms
5. Clean, organized layout matching app design
6. Works for both authenticated and guest users

## Tasks / Subtasks

- [ ] **Task 1: Create Settings Page** (AC: 1, 5)
  - [ ] Create `apps/web/src/pages/SettingsPage.tsx`
  - [ ] Add route `/settings` to router
  - [ ] Add to navigation menu/bottom nav
  - [ ] Gear icon in navigation

- [ ] **Task 2: Account Info Section** (AC: 2, 6)
  - [ ] Display user email (if authenticated)
  - [ ] Display auth provider badge (Google/Apple)
  - [ ] Show "Guest Mode" label for guests
  - [ ] Show avatar or initials

- [ ] **Task 3: Auth Actions** (AC: 3)
  - [ ] For guests: "Sign In" button â†’ auth page
  - [ ] For authenticated: "Sign Out" button (reuse from Story 1.5)
  - [ ] Clear visual distinction

- [ ] **Task 4: Settings Menu Links** (AC: 4)
  - [ ] "Manage Car Tags" â†’ /settings/tags (Story 5.2)
  - [ ] "Data Retention" â†’ /settings/retention (Story 5.3)
  - [ ] "Download My Data" â†’ triggers export (Story 5.4)
  - [ ] "Delete All Data" â†’ confirmation (Story 5.5)
  - [ ] "Delete Account" â†’ confirmation (Story 5.6) - authenticated only
  - [ ] "Privacy Policy" â†’ /privacy (Story 5.9)
  - [ ] "Terms of Service" â†’ /terms (Story 5.9)

- [ ] **Task 5: Settings Layout** (AC: 5)
  - [ ] Group related settings (Account, Data, Legal)
  - [ ] Consistent spacing and typography
  - [ ] Mobile-optimized touch targets
  - [ ] Chevron icons for navigation links

- [ ] **Task 6: Testing**
  - [ ] Test authenticated user view
  - [ ] Test guest user view
  - [ ] Test all navigation links work
  - [ ] Test responsive layout
  - [ ] Write Playwright E2E tests

## Dev Notes

### Architecture References

- [architecture-frontend/6-component-hierarchy.md](../architecture-frontend/6-component-hierarchy.md)
- [architecture-frontend/8-routing.md](../architecture-frontend/8-routing.md)

### Dependencies

- Story 1.5 (Sign Out functionality)
- All other Story 5.x features (links to them)

### Settings Page Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš™ï¸ Settings                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ðŸ‘¤ john@example.com                â”‚
â”‚     Signed in with Google           â”‚
â”‚                                     â”‚
â”‚     [ Sign Out ]                    â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACCOUNT                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸš— Manage Car Tags              >   â”‚
â”‚ ðŸ—“ï¸ Data Retention               >   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DATA                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ“¥ Download My Data             >   â”‚
â”‚ ðŸ—‘ï¸ Delete All Data              >   â”‚
â”‚ âŒ Delete Account               >   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LEGAL                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ“œ Privacy Policy               >   â”‚
â”‚ ðŸ“‹ Terms of Service             >   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ v1.0.0                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Settings Page Component

```tsx
// pages/SettingsPage.tsx
import { useAuthStore } from '@/stores/authStore';

export function SettingsPage() {
  const { user, isGuest, signOut } = useAuthStore();
  const navigate = useNavigate();

  return (
    <div className="min-h-screen bg-gray-50">
      <header className="bg-white p-4 border-b">
        <h1 className="text-xl font-bold">Settings</h1>
      </header>

      <div className="p-4 space-y-6">
        {/* Account Section */}
        <section className="bg-white rounded-lg p-4">
          <div className="flex items-center gap-3 mb-4">
            <Avatar user={user} />
            <div>
              {isGuest ? (
                <>
                  <p className="font-medium">Guest Mode</p>
                  <p className="text-sm text-gray-500">Sign in to sync across devices</p>
                </>
              ) : (
                <>
                  <p className="font-medium">{user?.email}</p>
                  <p className="text-sm text-gray-500">Signed in with {user?.provider}</p>
                </>
              )}
            </div>
          </div>

          {isGuest ? (
            <Button onClick={() => navigate('/auth')} className="w-full">
              Sign In
            </Button>
          ) : (
            <Button onClick={signOut} variant="secondary" className="w-full">
              Sign Out
            </Button>
          )}
        </section>

        {/* Settings Groups */}
        <SettingsGroup title="ACCOUNT">
          <SettingsLink to="/settings/tags" icon={Car} label="Manage Car Tags" />
          <SettingsLink to="/settings/retention" icon={Calendar} label="Data Retention" />
        </SettingsGroup>

        <SettingsGroup title="DATA">
          <SettingsButton onClick={handleExport} icon={Download} label="Download My Data" />
          <SettingsLink to="/settings/delete-data" icon={Trash} label="Delete All Data" />
          {!isGuest && (
            <SettingsLink to="/settings/delete-account" icon={UserX} label="Delete Account" />
          )}
        </SettingsGroup>

        <SettingsGroup title="LEGAL">
          <SettingsLink to="/privacy" icon={FileText} label="Privacy Policy" />
          <SettingsLink to="/terms" icon={FileText} label="Terms of Service" />
        </SettingsGroup>

        <p className="text-center text-sm text-gray-400">v{APP_VERSION}</p>
      </div>
    </div>
  );
}
```

### File Locations

**New Files:**

- `apps/web/src/pages/SettingsPage.tsx`
- `apps/web/src/components/settings/SettingsGroup.tsx`
- `apps/web/src/components/settings/SettingsLink.tsx`
- `apps/web/src/components/settings/SettingsButton.tsx`
- `apps/web/src/components/settings/Avatar.tsx`

**Modified Files:**

- `apps/web/src/router.tsx` - add /settings route
- `apps/web/src/components/navigation/BottomNav.tsx` - add Settings tab

### Testing Coverage

- SettingsPage: 90%
- Settings components: 95%
- Navigation: 100%

## Change Log

| Date       | Version | Description            | Author |
| ---------- | ------- | ---------------------- | ------ |
| 2026-01-15 | 1.0     | Initial story creation | PO     |
